{% for server in servers %}
    <article>
        <header>
            <strong>{{ server.server_name }}</strong>
            {% if let Some(error) = server.error %}
                <span style="color: #dc3545; float: right;">{{ error }}</span>
            {% endif %}
        </header>
        {% if !server.items.is_empty() %}
            <div class="grid" style="grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem;">
                {% for item in server.items %}
                    <div style="text-align: center; padding: 0.5rem; border: 1px solid var(--pico-muted-border-color); border-radius: 0.5rem; overflow: hidden;">
                        <div style="aspect-ratio: 2/3; background-color: #000; margin-bottom: 0.5rem; border-radius: 0.25rem; overflow: hidden;">
                            <img src="{{ ui_route }}/user/media/image/{{ server.server_id }}/{{ item.id }}" 
                                 alt="{{ item.name }}" 
                                 style="width: 100%; height: 100%; object-fit: cover;"
                                 loading="lazy">
                        </div>
                        <div style="font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{ item.name }}</div>
                        <small style="color: var(--pico-muted-color);">
                            {% match item.production_year %}
                                {% when Some with (year) %}
                                    {{ year }}
                                {% when None %}
                            {% endmatch %}
                        </small>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            {% if server.error.is_none() %}
                <p style="color: var(--pico-muted-color);">No media found.</p>
            {% endif %}
        {% endif %}
    </article>
{% endfor %}

{% if servers.is_empty() %}
    <div style="text-align: center; padding: 2rem;">
        <p>No servers mapped.</p>
    </div>
{% endif %}
